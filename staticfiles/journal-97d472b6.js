var p=(s,n,l)=>new Promise((h,a)=>{var v=o=>{try{u(l.next(o))}catch(c){a(c)}},g=o=>{try{u(l.throw(o))}catch(c){a(c)}},u=o=>o.done?h(o.value):Promise.resolve(o.value).then(v,g);u((l=l.apply(s,n)).next())});import{a as y,v as G,t as V,d as N,b as d,h as m,j as k,w as _,e as x,m as O,g as e,n as A,T,r as f,c as $,f as j,z as D,A as Q,i as C,B as E,q as X,C as ee,x as M,u as J,F as te,y as ne,k as oe,p as Z,D as le,l as ae,E as se,G as re}from"./config-4f765b06.js";let I=null;const ie=document.querySelector("[name=csrfmiddlewaretoken]").value;y.interceptors.request.use(s=>(s.headers["X-CSRFTOKEN"]=ie,s),s=>Promise.reject(s));try{I=JSON.parse(document.getElementById("JOURNAL-API-BASE-URL").textContent)}catch(s){console.log(`Couldn't parse JOURNAL-API-BASE-URL: ${s}`)}function L(s=null,n=null,l=null){const h=G();return{journal_id:s||h,journal_name:n||"New Journal",journal_data:l||"",date_modified:V(new Date),date_created:V(new Date)}}function ue(s){return p(this,null,function*(){if(s)try{const{data:n,status:l}=yield y.post(I,{},{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});return n.journal_id}catch(n){return y.isAxiosError(n)?(console.log("Error while creating journal: ",n.message),n.message):(console.log("Error while creating journal: ",n),"An unexpected error occurred")}else return L().journal_id})}function de(s,n){return p(this,null,function*(){if(n)try{const{status:l}=yield y.patch(I+s.journal_id,{journal_name:s.journal_name,journal_data:s.journal_data},{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});return l}catch(l){return y.isAxiosError(l)?(console.log("Error while updating journal: ",l.message),l.message):(console.log("Unexpected error while updating journal: ",l),"An unexpected error occurred")}else return 200})}function ce(s,n){return p(this,null,function*(){if(n)try{const{status:l}=yield y.delete(I+s,{withCredentials:!0});return l}catch(l){return y.isAxiosError(l)?(console.log("Error while deleting journal: ",l.message),l.message):(console.log("Unexpected error while deleting journal: ",l),"An unexpected error occurred")}else return 204})}const me={class:"flex list-disc ml-4 flex-col"},ve=N({__name:"JournalComponent",props:{text:{},loggedIn:{type:Boolean}},setup(s){return(n,l)=>(d(),m("ul",me,[k(T,null,{default:_(()=>[x(e("textarea",{class:A(["w-full resize-none rounded px-2 py-2 align-middle text-sm transition duration-300 ease-out bg-backg placeholder-textblackdimmer2 focus:outline-none",{"bg-primarylight":n.focused}]),placeholder:"âœŽ...",rows:"1","onUpdate:modelValue":l[0]||(l[0]=h=>n.text=h),type:"text"},null,2),[[O,n.text]])]),_:1})]))}}),ge={class:"my-2 flex justify-between"},he=["textContent"],pe=["textContent"],fe={key:0,class:"h-7 w-7",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-label":"Delete Tree"},we=e("path",{d:"m18 6-.8 12.013c-.071 1.052-.106 1.578-.333 1.977a2 2 0 0 1-.866.81c-.413.2-.94.2-1.995.2H9.994c-1.055 0-1.582 0-1.995-.2a2 2 0 0 1-.866-.81c-.227-.399-.262-.925-.332-1.977L6 6M4 6h16m-4 0-.27-.812c-.263-.787-.394-1.18-.637-1.471a2 2 0 0 0-.803-.578C13.938 3 13.524 3 12.694 3h-1.388c-.829 0-1.244 0-1.596.139a2 2 0 0 0-.803.578c-.243.29-.374.684-.636 1.471L8 6",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),xe=[we],_e={key:1,class:"h-7 w-7 fill-warning",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ye=e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.5 12a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Zm1.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9.75 1.5V8.25h1.5v5.25h-1.5Zm0 2.25v-1.5h1.5v1.5h-1.5Z"},null,-1),ke=[ye],je={key:2,class:"h-7 w-7 animate-spin",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},be=e("path",{d:"M20 12a8 8 0 0 1-11.76 7.061",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1),Je=[be],Ce=N({__name:"JournalListItemComponent",props:{journal:{},lastRemainingJournal:{type:Boolean},selectedJournalId:{},loggedIn:{type:Boolean}},emits:["selectJournal","deleteJournal"],setup(s,{emit:n}){const l=s,h=f(!1),a=f(!1),v=f(!1);function g(o){return p(this,null,function*(){v.value?(yield u(o),v.value=!1):(v.value=!0,setTimeout(()=>{v.value=!1},2e3))})}function u(o){return p(this,null,function*(){a.value=!0,(yield ce(o,l.loggedIn))===204?(h.value=!0,yield new Promise(w=>{setTimeout(()=>{n("deleteJournal",o),w()},152)})):a.value=!1})}return(o,c)=>(d(),$(X,null,{default:_(()=>[x(e("li",ge,[e("a",{href:"#",class:A(["flex flex-grow flex-col rounded-md px-2 py-2 transition duration-100 ease-out text-textblackdimmer",{"bg-primary text-white":o.journal.journal_id===o.selectedJournalId,"hover:bg-primarylight hover:text-black":o.journal.journal_id!==o.selectedJournalId}]),onClick:c[0]||(c[0]=w=>n("selectJournal",o.journal.journal_id))},[e("span",{textContent:D(o.journal.journal_name)},null,8,he),o.loggedIn?(d(),m("div",{key:0,class:A(["text-xs text-textblackdimmer2",{"text-textwhitedimmer2":o.journal.journal_id===o.selectedJournalId}]),textContent:D(`${Q(o.journal.date_modified)}`)},null,10,pe)):C("",!0)],2),x(e("button",{class:"mx-3 items-center rounded-md px-2 py-2 transition duration-100 ease-out text-textblackdimmer hover:bg-primarylight hover:text-black",onClick:c[1]||(c[1]=w=>g(o.journal.journal_id))},[k(E,{duration:"50"},{default:_(()=>[!a.value&&!v.value?(d(),m("svg",fe,xe)):v.value?(d(),m("svg",_e,ke)):a.value?(d(),m("svg",je,Je)):C("",!0)]),_:1})],512),[[j,!o.lastRemainingJournal]])],512),[[j,!h.value]])]),_:1}))}}),Ie={class:"mx-auto my-2 w-full overflow-x-hidden px-4"},Be=e("div",{class:"text-4xl text-center font-semibold text-textblackdimmer mt-8"}," Journal ",-1),Me={class:"flex h-full w-full flex-col items-center gap-y-10 lg:flex-row lg:items-start lg:gap-x-5"},Se={class:"mt-8 w-full rounded-md bg-white px-3 py-2 shadow-lg sm:mb-10 ring-1 ring-opacity-5 ring-primarylight focus:outline-none lg:w-96"},Ae={class:"divide-y divide-solid divide-primarylight"},Te={key:0,class:"flex gap-x-3"},$e=e("svg",{class:"h-6 w-6",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M30 28c0 1.1-.896 2-2 2H4c-1.104 0-2-.9-2-2V4c0-1.1.896-2 2-2h24c1.104 0 2 .9 2 2v24ZM28 0H4a4 4 0 0 0-4 4v24a4 4 0 0 0 4 4h24a4 4 0 0 0 4-4V4a4 4 0 0 0-4-4Zm-6 15h-5v-5c0-.55-.448-1-1-1s-1 .45-1 1v5h-5c-.552 0-1 .45-1 1s.448 1 1 1h5v5c0 .55.448 1 1 1s1-.45 1-1v-5h5c.552 0 1-.45 1-1s-.448-1-1-1Z",fill:"currentColor","fill-rule":"evenodd"})],-1),Ee=e("span",null," Create new ",-1),Le=[$e,Ee],Ne={key:1,class:"h-6 w-6animate-spin",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Re=e("path",{d:"M20 12a8 8 0 0 1-11.76 7.061",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1),Ve=[Re],De={key:2},Ze=e("div",{class:"text-danger"},"Maximum number of journals reached",-1),Oe=e("div",null," This limit is just to prevent spam. You're awesome for reaching this limit! Please do contact me if you'd like to have more journals at once! ",-1),Ue=[Ze,Oe],He={class:"max-h-80 list-none overflow-y-scroll sm:max-h-96"},Pe={class:"mx-auto flex w-full flex-col gap-y-6 text-textblackdim lg:my-8 lg:px-6"},ze={class:"flex flex-col gap-y-3 sm:flex-row sm:justify-between"},We={class:"flex text-textblackdim"},Fe={class:"mx-1 flex items-center gap-x-1 sm:mx-4"},Ye={class:"relative text-textblackdimmer"},qe={key:0,class:"h-8 w-8 animate-spin",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ke=e("path",{d:"M14.393 5.374c3.632 1.332 5.505 5.378 4.183 9.038a7.008 7.008 0 0 1-5.798 4.597m0 0 1.047-1.754m-1.047 1.754 1.71.991m-4.881-1.374c-3.632-1.332-5.505-5.378-4.183-9.038a7.008 7.008 0 0 1 5.798-4.597m0 0-1.047 1.754m1.047-1.754L9.512 4","stroke-width":"1.5",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Ge=[Ke],Qe={key:1,class:"h-8 w-8",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xe=e("path",{d:"M16.5 5.385a8 8 0 0 1-5.707 14.525M13.16 4.083A8 8 0 0 0 7.405 18.55M13.16 4.083 12.5 3m.66 1.083L12.5 5m-1.707 14.91.963-.91m-.963.91L11.5 21M9 12l2 2 4-4","stroke-width":"1.5",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),et=[Xe],tt=e("path",{d:"M15.938 6.12A7.135 7.135 0 0 1 19 12c0 3.927-3.134 7.111-7 7.111-.359 0-.711-.027-1.056-.08m2.07-14.068A6.949 6.949 0 0 0 12 4.89c-3.866 0-7 3.184-7 7.111a7.136 7.136 0 0 0 2.979 5.822m5.036-12.859L12.437 4m.578.963-.578.815M10.944 19.03l.843-.809m-.843.809.618.969M12 9v3.5m0 2v.5","stroke-width":"1.5",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),nt=[tt],ot={class:"absolute top-0 right-0 mt-14 -ml-32 inline-block w-60 rounded-lg bg-white px-4 py-3 ring-1 ring-opacity-5 text-textblackdim ring-danger focus:outline-none"},lt=e("span",{class:"inline-block text-sm leading-tight"},"Couldn't save gratitude journal data to your account. If a refresh doesn't solve the issue, please contact the admin.",-1),at=[lt],st={class:"relative flex cursor-pointer items-center text-textblackdim hover:text-gray-600"},rt={class:"absolute top-0 right-0 mt-14 -ml-32 inline-block w-60 rounded-lg bg-white px-4 py-3 ring-1 ring-opacity-5 text-textblackdim ring-warning focus:outline-none"},it=e("span",{class:"inline-block text-sm leading-tight"},"Your data has been saved to this device only. Log in to save and access your data from any device.",-1),ut=[it],dt=e("button",null,[e("svg",{class:"h-8 w-8 fill-warning",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.5 12a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Zm1.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9.75 1.5V8.25h1.5v5.25h-1.5Zm0 2.25v-1.5h1.5v1.5h-1.5Z"})])],-1),ct={class:"mb-40 w-full sm:mb-10 lg:mb:20"},S=150,mt=N({__name:"App",setup(s){const n=JSON.parse(document.getElementById("logged-in").textContent),l=ee("journal-store",{journals:[L()]});let h=se.SYNC_TIMER_DURATION_MS;const a=f([]);let v=null;const g=f("synced"),u=f(0),o=f(!1),c=f(!1),w=f(!1);U();function U(){n?(a.value=JSON.parse(document.getElementById("user-journals").textContent),z()):a.value=l.value.journals}const H=M(()=>a.value.length===1),P=M(()=>a.value[u.value].journal_id),B=M(()=>a.value.length);window.addEventListener("beforeunload",function(i){if(n&&g.value==="syncing"){const t="You have unsaved changes. Are you sure you want to leave?";return i.returnValue=t,t}});function R(i){const t=a.value[i];le(t,(r,b)=>{g.value="syncing",v&&clearTimeout(v),v=setTimeout(()=>p(this,null,function*(){(yield de(t,n))===200?g.value="synced":g.value="failed"}),h)})}function z(){for(const i in a.value)R(i)}function W(i){const t=a.value.findIndex(r=>r.journal_id===i);t!==-1&&R(t.toString())}function F(i){const t=a.value.findIndex(r=>r.journal_id===i);t!==-1&&u.value!=t&&(u.value=t)}function Y(i){return p(this,null,function*(){if(B.value<S){w.value=i;const t=yield ue(i),r=L(t);a.value.splice(0,0,r),i&&W(t),w.value=!1}})}function q(i){return p(this,null,function*(){const t=a.value.findIndex(r=>r.journal_id===i);t!==-1&&(u.value,u.value=0,a.value.splice(t,1))})}function K(i){i.target.blur()}return(i,t)=>(d(),m("div",Ie,[Be,e("div",Me,[e("div",Se,[e("div",Ae,[e("div",null,[e("button",{class:"my-2 rounded-md px-2 py-2 transition duration-100 ease-out text-textblackdimmer hover:bg-primarylight hover:text-black",onClick:t[0]||(t[0]=r=>Y(J(n)))},[k(E,{duration:"50"},{default:_(()=>[!w.value&&B.value<S?(d(),m("div",Te,Le)):w.value?(d(),m("svg",Ne,Ve)):B.value>=S?(d(),m("div",De,Ue)):C("",!0)]),_:1})])]),e("ul",He,[(d(!0),m(te,null,ne(a.value,r=>(d(),$(Z(Ce),{key:r.journal_id,journal:r,"selected-journal-id":P.value,"last-remaining-journal":H.value,"logged-in":J(n),onSelectJournal:t[1]||(t[1]=b=>F(b)),onDeleteJournal:t[2]||(t[2]=b=>q(b))},null,40,["journal","selected-journal-id","last-remaining-journal","logged-in"]))),128))])])]),e("div",Pe,[e("div",ze,[e("div",We,[x(e("input",{class:"rounded px-5 py-2 shadow-lg ring-1 ring-opacity-5 transition duration-100 ease-out bg-backg ring-primarylight focus:outline-none",id:"selected-tree-name-input",type:"text",maxlength:"22","onUpdate:modelValue":t[3]||(t[3]=r=>a.value[u.value].journal_name=r),onKeydown:t[4]||(t[4]=oe(ae(r=>K(r),["exact","prevent","stop"]),["enter"]))},null,544),[[O,a.value[u.value].journal_name]])]),e("div",Fe,[e("div",Ye,[k(E,null,{default:_(()=>[g.value==="syncing"?(d(),m("svg",qe,Ge)):g.value==="synced"?(d(),m("svg",Qe,et)):g.value==="failed"?(d(),m("svg",{key:2,onMouseover:t[5]||(t[5]=r=>c.value=!0),onMouseleave:t[6]||(t[6]=r=>c.value=!1),class:"h-8 w-8 text-danger",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},nt,32)):C("",!0)]),_:1}),k(T,{duration:"150"},{default:_(()=>[x(e("div",ot,at,512),[[j,g.value==="failed"&&c.value]])]),_:1})]),x(e("div",{class:"text-textblackdim",onMouseover:t[7]||(t[7]=r=>o.value=!0),onMouseleave:t[8]||(t[8]=r=>o.value=!1)},[e("div",st,[k(T,{duration:"150"},{default:_(()=>[x(e("div",rt,ut,512),[[j,o.value]])]),_:1}),dt])],544),[[j,!J(n)]])])]),e("div",ct,[x((d(),$(Z(ve),{nodes:a.value[u.value].journal_data,"logged-in":J(n)},null,8,["nodes","logged-in"])),[[j,a.value.length!==0&&a.value[u.value]]])])])])]))}}),vt=re(mt);vt.mount("#app");
