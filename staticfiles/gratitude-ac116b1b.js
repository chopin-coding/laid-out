var h=(d,n,a)=>new Promise((p,l)=>{var u=t=>{try{i(a.next(t))}catch(r){l(r)}},s=t=>{try{i(a.throw(t))}catch(r){l(r)}},i=t=>t.done?p(t.value):Promise.resolve(t.value).then(u,s);i((a=a.apply(d,n)).next())});import{a as k,v as V,t as D,d as $,r as _,o as ae,b as g,c as J,w as y,e as w,f as x,g as e,j as b,k as Z,l as U,n as A,m as O,T as S,u as j,q as F,s as P,x as G,h as f,F as z,y as W,p as E,z as R,A as se,i as I,B as H,C as ie,D as re,E as de,G as ue}from"./config-4f765b06.js";let B=null;const ce=document.querySelector("[name=csrfmiddlewaretoken]").value;k.interceptors.request.use(d=>(d.headers["X-CSRFTOKEN"]=ce,d),d=>Promise.reject(d));try{B=JSON.parse(document.getElementById("GRATITUDE-JOURNAL-API-BASE-URL").textContent)}catch(d){console.log(`Couldn't parse GRATITUDE-JOURNAL-API-BASE-URL: ${d}`)}function K(){return{title:"",node_id:V()}}function ge(){return[K()]}function L(d=null,n=null,a=null){const p=V();return{g_journal_id:d||p,g_journal_name:n||"New Gratitude",g_journal_data:a||ge(),date_modified:D(new Date),date_created:D(new Date)}}function me(d){return h(this,null,function*(){if(d)try{const{data:n,status:a}=yield k.post(B,{},{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});return n.g_journal_id}catch(n){return k.isAxiosError(n)?(console.log("Error while creating gratitude journal: ",n.message),n.message):(console.log("Error while creating gratitude journal: ",n),"An unexpected error occurred")}else return L().g_journal_id})}function ve(d,n){return h(this,null,function*(){if(n)try{const{status:a}=yield k.patch(B+d.g_journal_id,{g_journal_name:d.g_journal_name,g_journal_data:d.g_journal_data},{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});return a}catch(a){return k.isAxiosError(a)?(console.log("Error while updating gratitude journal: ",a.message),a.message):(console.log("Unexpected error while updating gratitude journal: ",a),"An unexpected error occurred")}else return 200})}function pe(d,n){return h(this,null,function*(){if(n)try{const{status:a}=yield k.delete(B+d,{withCredentials:!0});return a}catch(a){return k.isAxiosError(a)?(console.log("Error while deleting gratitude journal: ",a.message),a.message):(console.log("Unexpected error while deleting gratitude journal: ",a),"An unexpected error occurred")}else return 204})}const fe={class:"flex w-full min-w-0 gap-x-1 justify-self-start"},he={class:"flex w-full"},_e=["id"],we={class:"flex text-textblackdimmer"},xe=e("svg",{viewBox:"0 0 24 24",class:"h-8 w-8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"m9 13 3 3m0 0 3-3m-3 3V8M7.2 20h9.6c1.12 0 1.68 0 2.108-.218a2 2 0 0 0 .874-.874C20 18.48 20 17.92 20 16.8V7.2c0-1.12 0-1.68-.218-2.108a2 2 0 0 0-.874-.874C18.48 4 17.92 4 16.8 4H7.2c-1.12 0-1.68 0-2.108.218a2 2 0 0 0-.874.874C4 5.52 4 6.08 4 7.2v9.6c0 1.12 0 1.68.218 2.108a2 2 0 0 0 .874.874C5.52 20 6.08 20 7.2 20Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),ye=[xe],ke=e("svg",{viewBox:"0 0 24 24",class:"h-8 w-8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"m12 9.5 5 5m0-5-5 5m-7.492-.545 2.932 3.8c.352.457.528.685.75.85a2 2 0 0 0 .652.32c.266.075.554.075 1.131.075H17.8c1.12 0 1.68 0 2.108-.218a2 2 0 0 0 .874-.874C21 17.48 21 16.92 21 15.8V8.2c0-1.12 0-1.68-.218-2.108a2 2 0 0 0-.874-.874C19.481 5 18.92 5 17.8 5H9.973c-.577 0-.865 0-1.13.075a2 2 0 0 0-.653.32c-.222.165-.398.393-.75.85l-2.932 3.8c-.54.7-.81 1.05-.913 1.435a2 2 0 0 0 0 1.04c.104.385.374.735.913 1.435Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),be=[ke],je=$({__name:"GratitudeJournalNodeComponent",props:{node:{},loggedIn:{type:Boolean},singleNodeLeft:{type:Boolean}},emits:["deleteBtnHandler","siblingBtnHandler"],setup(d,{emit:n}){const a=d,p=_(!1),l=_(!1),u=_(!1);function s(){let t=document.getElementById(`${a.node.node_id}-titleInput`);t.style.height="18px",t.style.height=t.scrollHeight+"px"}function i(){return h(this,null,function*(){l.value=!0,yield P(),s()})}return ae(()=>{s()}),(t,r)=>(g(),J(F,null,{default:y(()=>[w(e("li",null,[e("div",{class:"flex justify-between gap-x-1 group text-textblackdim",onMouseover:r[5]||(r[5]=v=>p.value=!0),onMouseleave:r[6]||(r[6]=v=>p.value=!1)},[e("div",fe,[e("div",he,[b(S,null,{default:y(()=>[w(e("textarea",{onKeydown:r[0]||(r[0]=Z(U(v=>n("siblingBtnHandler",t.node.node_id),["exact","prevent","stop"]),["enter"])),onInput:s,class:A(["w-full resize-none rounded px-2 py-2 align-middle text-sm transition duration-300 ease-out bg-backg placeholder-textblackdimmer2 focus:outline-none",{"bg-primarylight":l.value}]),placeholder:"âœŽ...",rows:"1","onUpdate:modelValue":r[1]||(r[1]=v=>t.node.title=v),type:"text",id:`${t.node.node_id}-titleInput`,onFocusin:i,onFocusout:r[2]||(r[2]=v=>l.value=!1)},null,42,_e),[[O,t.node.title]])]),_:1})])]),w(e("div",we,[e("button",{class:"transition duration-100 ease-out hover:text-black",onClick:r[3]||(r[3]=v=>n("siblingBtnHandler",t.node.node_id))},ye),w(e("button",{class:"transition duration-100 ease-out hover:text-black",onClick:r[4]||(r[4]=v=>{n("deleteBtnHandler",j(a).node.node_id),u.value=!0})},be,512),[[x,!t.singleNodeLeft]])],512),[[x,p.value||l.value]])],32)],512),[[x,!u.value]])]),_:1}))}}),Je={class:"flex list-disc ml-4 flex-col"},Ce=$({__name:"GratitudeJournalComponent",props:{nodes:{},loggedIn:{type:Boolean}},setup(d){const n=d,a=G(()=>n.nodes.length===1);function p(u){return h(this,null,function*(){const s=n.nodes.findIndex(t=>t.node_id===u)+1,i=K();s!==-1&&n.nodes.splice(s,0,i),yield P(),document.getElementById(`${i.node_id}-titleInput`).focus()})}function l(u){return h(this,null,function*(){const s=n.nodes.findIndex(t=>t.node_id===u);let i=null;n.nodes.length>1&&(s===0?i=n.nodes[s+1].node_id:i=n.nodes[s-1].node_id,document.getElementById(`${i}-titleInput`).focus()),yield new Promise(t=>{setTimeout(()=>{n.nodes.splice(s,1),t()},152)})})}return(u,s)=>(g(),f("ul",Je,[(g(!0),f(z,null,W(u.nodes,i=>(g(),J(E(je),{key:i.node_id,node:i,"logged-in":u.loggedIn,"single-node-left":a.value,onDeleteBtnHandler:s[0]||(s[0]=t=>l(t)),onSiblingBtnHandler:s[1]||(s[1]=t=>p(t))},null,40,["node","logged-in","single-node-left"]))),128))]))}}),Ge={class:"my-2 flex justify-between"},Ie=["textContent"],$e=["textContent"],Be={key:0,class:"h-7 w-7",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-label":"Delete Tree"},Te=e("path",{d:"m18 6-.8 12.013c-.071 1.052-.106 1.578-.333 1.977a2 2 0 0 1-.866.81c-.413.2-.94.2-1.995.2H9.994c-1.055 0-1.582 0-1.995-.2a2 2 0 0 1-.866-.81c-.227-.399-.262-.925-.332-1.977L6 6M4 6h16m-4 0-.27-.812c-.263-.787-.394-1.18-.637-1.471a2 2 0 0 0-.803-.578C13.938 3 13.524 3 12.694 3h-1.388c-.829 0-1.244 0-1.596.139a2 2 0 0 0-.803.578c-.243.29-.374.684-.636 1.471L8 6",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Me=[Te],Ae={key:1,class:"h-7 w-7 fill-warning",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Se=e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.5 12a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Zm1.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9.75 1.5V8.25h1.5v5.25h-1.5Zm0 2.25v-1.5h1.5v1.5h-1.5Z"},null,-1),Ee=[Se],He={key:2,class:"h-7 w-7 animate-spin",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Le=e("path",{d:"M20 12a8 8 0 0 1-11.76 7.061",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1),Ne=[Le],De=$({__name:"GratitudeJournalListItemComponent",props:{gratitudeJournal:{},lastRemainingGratitudeJournal:{type:Boolean},selectedGratitudeJournalId:{},loggedIn:{type:Boolean}},emits:["selectGratitudeJournal","deleteGratitudeJournal"],setup(d,{emit:n}){const a=d,p=_(!1),l=_(!1),u=_(!1);function s(t){return h(this,null,function*(){u.value?(yield i(t),u.value=!1):(u.value=!0,setTimeout(()=>{u.value=!1},2e3))})}function i(t){return h(this,null,function*(){l.value=!0,(yield pe(t,a.loggedIn))===204?(p.value=!0,yield new Promise(v=>{setTimeout(()=>{n("deleteGratitudeJournal",t),v()},152)})):l.value=!1})}return(t,r)=>(g(),J(F,null,{default:y(()=>[w(e("li",Ge,[e("a",{href:"#",class:A(["flex flex-grow flex-col rounded-md px-2 py-2 transition duration-100 ease-out text-textblackdimmer",{"bg-primary text-white":t.gratitudeJournal.g_journal_id===t.selectedGratitudeJournalId,"hover:bg-primarylight hover:text-black":t.gratitudeJournal.g_journal_id!==t.selectedGratitudeJournalId}]),onClick:r[0]||(r[0]=v=>n("selectGratitudeJournal",t.gratitudeJournal.g_journal_id))},[e("span",{textContent:R(t.gratitudeJournal.g_journal_name)},null,8,Ie),t.loggedIn?(g(),f("div",{key:0,class:A(["text-xs text-textblackdimmer2",{"text-textwhitedimmer2":t.gratitudeJournal.g_journal_id===t.selectedGratitudeJournalId}]),textContent:R(`${se(t.gratitudeJournal.date_modified)}`)},null,10,$e)):I("",!0)],2),w(e("button",{class:"mx-3 items-center rounded-md px-2 py-2 transition duration-100 ease-out text-textblackdimmer hover:bg-primarylight hover:text-black",onClick:r[1]||(r[1]=v=>s(t.gratitudeJournal.g_journal_id))},[b(H,{duration:"50"},{default:y(()=>[!l.value&&!u.value?(g(),f("svg",Be,Me)):u.value?(g(),f("svg",Ae,Ee)):l.value?(g(),f("svg",He,Ne)):I("",!0)]),_:1})],512),[[x,!t.lastRemainingGratitudeJournal]])],512),[[x,!p.value]])]),_:1}))}}),Re={class:"mx-auto my-2 w-full overflow-x-hidden px-4"},Ve=e("div",{class:"text-4xl text-center font-semibold text-textblackdimmer mt-8"}," Gratitude Journal ",-1),Ze={class:"flex h-full w-full flex-col items-center gap-y-10 lg:flex-row lg:items-start lg:gap-x-5"},Ue={class:"mt-8 w-full rounded-md bg-white px-3 py-2 shadow-lg sm:mb-10 ring-1 ring-opacity-5 ring-primarylight focus:outline-none lg:w-96"},Oe={class:"divide-y divide-solid divide-primarylight"},Fe={key:0,class:"flex gap-x-3"},Pe=e("svg",{class:"h-6 w-6",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M30 28c0 1.1-.896 2-2 2H4c-1.104 0-2-.9-2-2V4c0-1.1.896-2 2-2h24c1.104 0 2 .9 2 2v24ZM28 0H4a4 4 0 0 0-4 4v24a4 4 0 0 0 4 4h24a4 4 0 0 0 4-4V4a4 4 0 0 0-4-4Zm-6 15h-5v-5c0-.55-.448-1-1-1s-1 .45-1 1v5h-5c-.552 0-1 .45-1 1s.448 1 1 1h5v5c0 .55.448 1 1 1s1-.45 1-1v-5h5c.552 0 1-.45 1-1s-.448-1-1-1Z",fill:"currentColor","fill-rule":"evenodd"})],-1),ze=e("span",null," Create new ",-1),We=[Pe,ze],Ke={key:1,class:"h-6 w-6animate-spin",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ye=e("path",{d:"M20 12a8 8 0 0 1-11.76 7.061",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1),qe=[Ye],Qe={key:2},Xe=e("div",{class:"text-danger"},"Maximum number of gratitude journals reached",-1),et=e("div",null," This limit is just to prevent spam. You're awesome for reaching this limit! Please do contact me if you'd like to have more gratitude journals at once! ",-1),tt=[Xe,et],nt={class:"max-h-80 list-none overflow-y-scroll sm:max-h-96"},ot={class:"mx-auto flex w-full flex-col gap-y-6 text-textblackdim lg:my-8 lg:px-6"},lt={class:"flex flex-col gap-y-3 sm:flex-row sm:justify-between"},at={class:"flex text-textblackdim"},st={class:"mx-1 flex items-center gap-x-1 sm:mx-4"},it={class:"relative text-textblackdimmer"},rt={key:0,class:"h-8 w-8 animate-spin",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},dt=e("path",{d:"M14.393 5.374c3.632 1.332 5.505 5.378 4.183 9.038a7.008 7.008 0 0 1-5.798 4.597m0 0 1.047-1.754m-1.047 1.754 1.71.991m-4.881-1.374c-3.632-1.332-5.505-5.378-4.183-9.038a7.008 7.008 0 0 1 5.798-4.597m0 0-1.047 1.754m1.047-1.754L9.512 4","stroke-width":"1.5",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),ut=[dt],ct={key:1,class:"h-8 w-8",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},gt=e("path",{d:"M16.5 5.385a8 8 0 0 1-5.707 14.525M13.16 4.083A8 8 0 0 0 7.405 18.55M13.16 4.083 12.5 3m.66 1.083L12.5 5m-1.707 14.91.963-.91m-.963.91L11.5 21M9 12l2 2 4-4","stroke-width":"1.5",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),mt=[gt],vt=e("path",{d:"M15.938 6.12A7.135 7.135 0 0 1 19 12c0 3.927-3.134 7.111-7 7.111-.359 0-.711-.027-1.056-.08m2.07-14.068A6.949 6.949 0 0 0 12 4.89c-3.866 0-7 3.184-7 7.111a7.136 7.136 0 0 0 2.979 5.822m5.036-12.859L12.437 4m.578.963-.578.815M10.944 19.03l.843-.809m-.843.809.618.969M12 9v3.5m0 2v.5","stroke-width":"1.5",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),pt=[vt],ft={class:"absolute top-0 right-0 mt-14 -ml-32 inline-block w-60 rounded-lg bg-white px-4 py-3 ring-1 ring-opacity-5 text-textblackdim ring-danger focus:outline-none"},ht=e("span",{class:"inline-block text-sm leading-tight"},"Couldn't save gratitude journal data to your account. If a refresh doesn't solve the issue, please contact the admin.",-1),_t=[ht],wt={class:"relative flex cursor-pointer items-center text-textblackdim hover:text-gray-600"},xt={class:"absolute top-0 right-0 mt-14 -ml-32 inline-block w-60 rounded-lg bg-white px-4 py-3 ring-1 ring-opacity-5 text-textblackdim ring-warning focus:outline-none"},yt=e("span",{class:"inline-block text-sm leading-tight"},"Your data has been saved to this device only. Log in to save and access your data from any device.",-1),kt=[yt],bt=e("button",null,[e("svg",{class:"h-8 w-8 fill-warning",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.5 12a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Zm1.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9.75 1.5V8.25h1.5v5.25h-1.5Zm0 2.25v-1.5h1.5v1.5h-1.5Z"})])],-1),jt={class:"mb-40 w-full sm:mb-10 lg:mb:20"},M=150,Jt=$({__name:"App",setup(d){const n=JSON.parse(document.getElementById("logged-in").textContent),a=ie("gratitude-journal-store",{gratitudeJournals:[L()]});let p=de.SYNC_TIMER_DURATION_MS;const l=_([]);let u=null;const s=_("synced"),i=_(0),t=_(!1),r=_(!1),v=_(!1);Y();function Y(){n?(l.value=JSON.parse(document.getElementById("user-g-journals").textContent),X()):l.value=a.value.gratitudeJournals}const q=G(()=>l.value.length===1),Q=G(()=>l.value[i.value].g_journal_id),T=G(()=>l.value.length);window.addEventListener("beforeunload",function(m){if(n&&s.value==="syncing"){const o="You have unsaved changes. Are you sure you want to leave?";return m.returnValue=o,o}});function N(m){const o=l.value[m];re(o,(c,C)=>{s.value="syncing",u&&clearTimeout(u),u=setTimeout(()=>h(this,null,function*(){(yield ve(o,n))===200?s.value="synced":s.value="failed"}),p)})}function X(){for(const m in l.value)N(m)}function ee(m){const o=l.value.findIndex(c=>c.g_journal_id===m);o!==-1&&N(o.toString())}function te(m){const o=l.value.findIndex(c=>c.g_journal_id===m);o!==-1&&i.value!=o&&(i.value=o)}function ne(m){return h(this,null,function*(){if(T.value<M){v.value=m;const o=yield me(m),c=L(o);l.value.splice(0,0,c),m&&ee(o),v.value=!1}})}function oe(m){return h(this,null,function*(){const o=l.value.findIndex(c=>c.g_journal_id===m);o!==-1&&(i.value,i.value=0,l.value.splice(o,1))})}function le(m){m.target.blur()}return(m,o)=>(g(),f("div",Re,[Ve,e("div",Ze,[e("div",Ue,[e("div",Oe,[e("div",null,[e("button",{class:"my-2 rounded-md px-2 py-2 transition duration-100 ease-out text-textblackdimmer hover:bg-primarylight hover:text-black",onClick:o[0]||(o[0]=c=>ne(j(n)))},[b(H,{duration:"50"},{default:y(()=>[!v.value&&T.value<M?(g(),f("div",Fe,We)):v.value?(g(),f("svg",Ke,qe)):T.value>=M?(g(),f("div",Qe,tt)):I("",!0)]),_:1})])]),e("ul",nt,[(g(!0),f(z,null,W(l.value,c=>(g(),J(E(De),{key:c.g_journal_id,"gratitude-journal":c,"selected-gratitude-journal-id":Q.value,"last-remaining-gratitude-journal":q.value,"logged-in":j(n),onSelectGratitudeJournal:o[1]||(o[1]=C=>te(C)),onDeleteGratitudeJournal:o[2]||(o[2]=C=>oe(C))},null,40,["gratitude-journal","selected-gratitude-journal-id","last-remaining-gratitude-journal","logged-in"]))),128))])])]),e("div",ot,[e("div",lt,[e("div",at,[w(e("input",{class:"rounded px-5 py-2 shadow-lg ring-1 ring-opacity-5 transition duration-100 ease-out bg-backg ring-primarylight focus:outline-none",id:"selected-tree-name-input",type:"text",maxlength:"22","onUpdate:modelValue":o[3]||(o[3]=c=>l.value[i.value].g_journal_name=c),onKeydown:o[4]||(o[4]=Z(U(c=>le(c),["exact","prevent","stop"]),["enter"]))},null,544),[[O,l.value[i.value].g_journal_name]])]),e("div",st,[e("div",it,[b(H,null,{default:y(()=>[s.value==="syncing"?(g(),f("svg",rt,ut)):s.value==="synced"?(g(),f("svg",ct,mt)):s.value==="failed"?(g(),f("svg",{key:2,onMouseover:o[5]||(o[5]=c=>r.value=!0),onMouseleave:o[6]||(o[6]=c=>r.value=!1),class:"h-8 w-8 text-danger",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},pt,32)):I("",!0)]),_:1}),b(S,{duration:"150"},{default:y(()=>[w(e("div",ft,_t,512),[[x,s.value==="failed"&&r.value]])]),_:1})]),w(e("div",{class:"text-textblackdim",onMouseover:o[7]||(o[7]=c=>t.value=!0),onMouseleave:o[8]||(o[8]=c=>t.value=!1)},[e("div",wt,[b(S,{duration:"150"},{default:y(()=>[w(e("div",xt,kt,512),[[x,t.value]])]),_:1}),bt])],544),[[x,!j(n)]])])]),e("div",jt,[w((g(),J(E(Ce),{nodes:l.value[i.value].g_journal_data,"logged-in":j(n)},null,8,["nodes","logged-in"])),[[x,l.value.length!==0&&l.value[i.value]]])])])])]))}}),Ct=ue(Jt);Ct.mount("#app");
