var p=(s,n,l)=>new Promise((g,a)=>{var v=o=>{try{u(l.next(o))}catch(c){a(c)}},h=o=>{try{u(l.throw(o))}catch(c){a(c)}},u=o=>o.done?g(o.value):Promise.resolve(o.value).then(v,h);u((l=l.apply(s,n)).next())});import{a as y,v as Q,t as R,d as L,b as d,h as m,j,w as x,e as _,m as Z,g as e,T as A,r as f,c as T,f as k,n as U,z as V,A as X,i as C,B as $,q as ee,C as te,x as M,u as J,F as ne,y as oe,k as le,p as D,D as ae,l as se,E as re,G as ie}from"./config-4f765b06.js";let I=null;const ue=document.querySelector("[name=csrfmiddlewaretoken]").value;y.interceptors.request.use(s=>(s.headers["X-CSRFTOKEN"]=ue,s),s=>Promise.reject(s));try{I=JSON.parse(document.getElementById("JOURNAL-API-BASE-URL").textContent)}catch(s){console.log(`Couldn't parse JOURNAL-API-BASE-URL: ${s}`)}function E(s=null,n=null,l=null){const g=Q();return{journal_id:s||g,journal_name:n||"New Journal",journal_data:l||"",date_modified:R(new Date),date_created:R(new Date)}}function de(s){return p(this,null,function*(){if(s)try{const{data:n,status:l}=yield y.post(I,{},{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});return n.journal_id}catch(n){return y.isAxiosError(n)?(console.log("Error while creating journal: ",n.message),n.message):(console.log("Error while creating journal: ",n),"An unexpected error occurred")}else return E().journal_id})}function ce(s,n){return p(this,null,function*(){if(n)try{const{status:l}=yield y.patch(I+s.journal_id,{journal_name:s.journal_name,journal_data:s.journal_data},{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});return l}catch(l){return y.isAxiosError(l)?(console.log("Error while updating journal: ",l.message),l.message):(console.log("Unexpected error while updating journal: ",l),"An unexpected error occurred")}else return 200})}function me(s,n){return p(this,null,function*(){if(n)try{const{status:l}=yield y.delete(I+s,{withCredentials:!0});return l}catch(l){return y.isAxiosError(l)?(console.log("Error while deleting journal: ",l.message),l.message):(console.log("Unexpected error while deleting journal: ",l),"An unexpected error occurred")}else return 204})}const ve={class:"flex list-disc ml-4 flex-col"},he=L({__name:"JournalComponent",props:{journal:{},loggedIn:{type:Boolean}},setup(s){return(n,l)=>(d(),m("ul",ve,[j(A,null,{default:x(()=>[_(e("textarea",{class:"w-full resize-none rounded px-2 py-2 align-middle text-sm transition duration-300 ease-out bg-backg placeholder-textblackdimmer2 focus:outline-none",placeholder:"âœŽ...",rows:"1","onUpdate:modelValue":l[0]||(l[0]=g=>n.journal.journal_data=g),type:"text"},null,512),[[Z,n.journal.journal_data]])]),_:1})]))}}),ge={class:"my-2 flex justify-between"},pe=["textContent"],fe=["textContent"],we={key:0,class:"h-7 w-7",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-label":"Delete Tree"},_e=e("path",{d:"m18 6-.8 12.013c-.071 1.052-.106 1.578-.333 1.977a2 2 0 0 1-.866.81c-.413.2-.94.2-1.995.2H9.994c-1.055 0-1.582 0-1.995-.2a2 2 0 0 1-.866-.81c-.227-.399-.262-.925-.332-1.977L6 6M4 6h16m-4 0-.27-.812c-.263-.787-.394-1.18-.637-1.471a2 2 0 0 0-.803-.578C13.938 3 13.524 3 12.694 3h-1.388c-.829 0-1.244 0-1.596.139a2 2 0 0 0-.803.578c-.243.29-.374.684-.636 1.471L8 6",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),xe=[_e],ye={key:1,class:"h-7 w-7 fill-warning",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},je=e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.5 12a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Zm1.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9.75 1.5V8.25h1.5v5.25h-1.5Zm0 2.25v-1.5h1.5v1.5h-1.5Z"},null,-1),ke=[je],be={key:2,class:"h-7 w-7 animate-spin",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Je=e("path",{d:"M20 12a8 8 0 0 1-11.76 7.061",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1),Ce=[Je],Ie=L({__name:"JournalListItemComponent",props:{journal:{},lastRemainingJournal:{type:Boolean},selectedJournalId:{},loggedIn:{type:Boolean}},emits:["selectJournal","deleteJournal"],setup(s,{emit:n}){const l=s,g=f(!1),a=f(!1),v=f(!1);function h(o){return p(this,null,function*(){v.value?(yield u(o),v.value=!1):(v.value=!0,setTimeout(()=>{v.value=!1},2e3))})}function u(o){return p(this,null,function*(){a.value=!0,(yield me(o,l.loggedIn))===204?(g.value=!0,yield new Promise(w=>{setTimeout(()=>{n("deleteJournal",o),w()},152)})):a.value=!1})}return(o,c)=>(d(),T(ee,null,{default:x(()=>[_(e("li",ge,[e("a",{href:"#",class:U(["flex flex-grow flex-col rounded-md px-2 py-2 transition duration-100 ease-out text-textblackdimmer",{"bg-primary text-white":o.journal.journal_id===o.selectedJournalId,"hover:bg-primarylight hover:text-black":o.journal.journal_id!==o.selectedJournalId}]),onClick:c[0]||(c[0]=w=>n("selectJournal",o.journal.journal_id))},[e("span",{textContent:V(o.journal.journal_name)},null,8,pe),o.loggedIn?(d(),m("div",{key:0,class:U(["text-xs text-textblackdimmer2",{"text-textwhitedimmer2":o.journal.journal_id===o.selectedJournalId}]),textContent:V(`${X(o.journal.date_modified)}`)},null,10,fe)):C("",!0)],2),_(e("button",{class:"mx-3 items-center rounded-md px-2 py-2 transition duration-100 ease-out text-textblackdimmer hover:bg-primarylight hover:text-black",onClick:c[1]||(c[1]=w=>h(o.journal.journal_id))},[j($,{duration:"50"},{default:x(()=>[!a.value&&!v.value?(d(),m("svg",we,xe)):v.value?(d(),m("svg",ye,ke)):a.value?(d(),m("svg",be,Ce)):C("",!0)]),_:1})],512),[[k,!o.lastRemainingJournal]])],512),[[k,!g.value]])]),_:1}))}}),Be={class:"mx-auto my-2 w-full overflow-x-hidden px-4"},Me=e("div",{class:"text-4xl text-center font-semibold text-textblackdimmer mt-8"}," Journal ",-1),Se={class:"flex h-full w-full flex-col items-center gap-y-10 lg:flex-row lg:items-start lg:gap-x-5"},Ae={class:"mt-8 w-full rounded-md bg-white px-3 py-2 shadow-lg sm:mb-10 ring-1 ring-opacity-5 ring-primarylight focus:outline-none lg:w-96"},Te={class:"divide-y divide-solid divide-primarylight"},$e={key:0,class:"flex gap-x-3"},Ee=e("svg",{class:"h-6 w-6",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M30 28c0 1.1-.896 2-2 2H4c-1.104 0-2-.9-2-2V4c0-1.1.896-2 2-2h24c1.104 0 2 .9 2 2v24ZM28 0H4a4 4 0 0 0-4 4v24a4 4 0 0 0 4 4h24a4 4 0 0 0 4-4V4a4 4 0 0 0-4-4Zm-6 15h-5v-5c0-.55-.448-1-1-1s-1 .45-1 1v5h-5c-.552 0-1 .45-1 1s.448 1 1 1h5v5c0 .55.448 1 1 1s1-.45 1-1v-5h5c.552 0 1-.45 1-1s-.448-1-1-1Z",fill:"currentColor","fill-rule":"evenodd"})],-1),Le=e("span",null," Create new ",-1),Ne=[Ee,Le],Re={key:1,class:"h-6 w-6animate-spin",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ue=e("path",{d:"M20 12a8 8 0 0 1-11.76 7.061",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1),Ve=[Ue],De={key:2},Ze=e("div",{class:"text-danger"},"Maximum number of journals reached",-1),Oe=e("div",null," This limit is just to prevent spam. You're awesome for reaching this limit! Please do contact me if you'd like to have more journals at once! ",-1),He=[Ze,Oe],Pe={class:"max-h-80 list-none overflow-y-scroll sm:max-h-96"},ze={class:"mx-auto flex w-full flex-col gap-y-6 text-textblackdim lg:my-8 lg:px-6"},We={class:"flex flex-col gap-y-3 sm:flex-row sm:justify-between"},Fe={class:"flex text-textblackdim"},Ye={class:"mx-1 flex items-center gap-x-1 sm:mx-4"},qe={class:"relative text-textblackdimmer"},Ke={key:0,class:"h-8 w-8 animate-spin",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ge=e("path",{d:"M14.393 5.374c3.632 1.332 5.505 5.378 4.183 9.038a7.008 7.008 0 0 1-5.798 4.597m0 0 1.047-1.754m-1.047 1.754 1.71.991m-4.881-1.374c-3.632-1.332-5.505-5.378-4.183-9.038a7.008 7.008 0 0 1 5.798-4.597m0 0-1.047 1.754m1.047-1.754L9.512 4","stroke-width":"1.5",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Qe=[Ge],Xe={key:1,class:"h-8 w-8",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},et=e("path",{d:"M16.5 5.385a8 8 0 0 1-5.707 14.525M13.16 4.083A8 8 0 0 0 7.405 18.55M13.16 4.083 12.5 3m.66 1.083L12.5 5m-1.707 14.91.963-.91m-.963.91L11.5 21M9 12l2 2 4-4","stroke-width":"1.5",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),tt=[et],nt=e("path",{d:"M15.938 6.12A7.135 7.135 0 0 1 19 12c0 3.927-3.134 7.111-7 7.111-.359 0-.711-.027-1.056-.08m2.07-14.068A6.949 6.949 0 0 0 12 4.89c-3.866 0-7 3.184-7 7.111a7.136 7.136 0 0 0 2.979 5.822m5.036-12.859L12.437 4m.578.963-.578.815M10.944 19.03l.843-.809m-.843.809.618.969M12 9v3.5m0 2v.5","stroke-width":"1.5",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),ot=[nt],lt={class:"absolute top-0 right-0 mt-14 -ml-32 inline-block w-60 rounded-lg bg-white px-4 py-3 ring-1 ring-opacity-5 text-textblackdim ring-danger focus:outline-none"},at=e("span",{class:"inline-block text-sm leading-tight"},"Couldn't save gratitude journal data to your account. If a refresh doesn't solve the issue, please contact the admin.",-1),st=[at],rt={class:"relative flex cursor-pointer items-center text-textblackdim hover:text-gray-600"},it={class:"absolute top-0 right-0 mt-14 -ml-32 inline-block w-60 rounded-lg bg-white px-4 py-3 ring-1 ring-opacity-5 text-textblackdim ring-warning focus:outline-none"},ut=e("span",{class:"inline-block text-sm leading-tight"},"Your data has been saved to this device only. Log in to save and access your data from any device.",-1),dt=[ut],ct=e("button",null,[e("svg",{class:"h-8 w-8 fill-warning",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.5 12a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Zm1.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9.75 1.5V8.25h1.5v5.25h-1.5Zm0 2.25v-1.5h1.5v1.5h-1.5Z"})])],-1),mt={class:"mb-40 w-full sm:mb-10 lg:mb:20"},S=150,vt=L({__name:"App",setup(s){const n=JSON.parse(document.getElementById("logged-in").textContent),l=te("journal-store",{journals:[E()]});let g=re.SYNC_TIMER_DURATION_MS;const a=f([]);let v=null;const h=f("synced"),u=f(0),o=f(!1),c=f(!1),w=f(!1);O();function O(){n?(a.value=JSON.parse(document.getElementById("user-journals").textContent),z()):a.value=l.value.journals}const H=M(()=>a.value.length===1),P=M(()=>a.value[u.value].journal_id),B=M(()=>a.value.length);window.addEventListener("beforeunload",function(r){if(n&&h.value==="syncing"){const t="You have unsaved changes. Are you sure you want to leave?";return r.returnValue=t,t}});function N(r){const t=a.value[r];ae(t,(i,b)=>{h.value="syncing",v&&clearTimeout(v),v=setTimeout(()=>p(this,null,function*(){(yield ce(t,n))===200?h.value="synced":h.value="failed"}),g)})}function z(){for(const r in a.value)N(r)}function W(r){const t=a.value.findIndex(i=>i.journal_id===r);t!==-1&&N(t.toString())}function F(r){const t=a.value.findIndex(i=>i.journal_id===r);t!==-1&&u.value!=t&&(u.value=t)}function Y(r){return p(this,null,function*(){if(B.value<S){w.value=r;const t=yield de(r),i=E(t);a.value.splice(0,0,i),r&&W(t),w.value=!1}})}function q(r){return p(this,null,function*(){const t=a.value.findIndex(i=>i.journal_id===r);t!==-1&&(u.value,u.value=0,a.value.splice(t,1))})}function K(r){a.value[u.value].journal_data.value=r}function G(r){r.target.blur()}return(r,t)=>(d(),m("div",Be,[Me,e("div",Se,[e("div",Ae,[e("div",Te,[e("div",null,[e("button",{class:"my-2 rounded-md px-2 py-2 transition duration-100 ease-out text-textblackdimmer hover:bg-primarylight hover:text-black",onClick:t[0]||(t[0]=i=>Y(J(n)))},[j($,{duration:"50"},{default:x(()=>[!w.value&&B.value<S?(d(),m("div",$e,Ne)):w.value?(d(),m("svg",Re,Ve)):B.value>=S?(d(),m("div",De,He)):C("",!0)]),_:1})])]),e("ul",Pe,[(d(!0),m(ne,null,oe(a.value,i=>(d(),T(D(Ie),{key:i.journal_id,journal:i,"selected-journal-id":P.value,"last-remaining-journal":H.value,"logged-in":J(n),onSelectJournal:t[1]||(t[1]=b=>F(b)),onDeleteJournal:t[2]||(t[2]=b=>q(b))},null,40,["journal","selected-journal-id","last-remaining-journal","logged-in"]))),128))])])]),e("div",ze,[e("div",We,[e("div",Fe,[_(e("input",{class:"rounded px-5 py-2 shadow-lg ring-1 ring-opacity-5 transition duration-100 ease-out bg-backg ring-primarylight focus:outline-none",id:"selected-tree-name-input",type:"text",maxlength:"22","onUpdate:modelValue":t[3]||(t[3]=i=>a.value[u.value].journal_name=i),onKeydown:t[4]||(t[4]=le(se(i=>G(i),["exact","prevent","stop"]),["enter"]))},null,544),[[Z,a.value[u.value].journal_name]])]),e("div",Ye,[e("div",qe,[j($,null,{default:x(()=>[h.value==="syncing"?(d(),m("svg",Ke,Qe)):h.value==="synced"?(d(),m("svg",Xe,tt)):h.value==="failed"?(d(),m("svg",{key:2,onMouseover:t[5]||(t[5]=i=>c.value=!0),onMouseleave:t[6]||(t[6]=i=>c.value=!1),class:"h-8 w-8 text-danger",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ot,32)):C("",!0)]),_:1}),j(A,{duration:"150"},{default:x(()=>[_(e("div",lt,st,512),[[k,h.value==="failed"&&c.value]])]),_:1})]),_(e("div",{class:"text-textblackdim",onMouseover:t[7]||(t[7]=i=>o.value=!0),onMouseleave:t[8]||(t[8]=i=>o.value=!1)},[e("div",rt,[j(A,{duration:"150"},{default:x(()=>[_(e("div",it,dt,512),[[k,o.value]])]),_:1}),ct])],544),[[k,!J(n)]])])]),e("div",mt,[_((d(),T(D(he),{journal:a.value[u.value],"logged-in":J(n),onJournalUpdate:K},null,40,["journal","logged-in"])),[[k,a.value.length!==0&&a.value[u.value]]])])])])]))}}),ht=ie(vt);ht.mount("#app");
