{% block head %}
  <script>
      // On page load or when changing themes, best to add inline in `head` to avoid FOUC
      if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark')
      } else {
          document.documentElement.classList.remove('dark')
      }

      function updateThemeBasedOnSystemPreference() {
          if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
              document.documentElement.classList.add('dark')
          } else {
              document.documentElement.classList.remove('dark')
          }
      }
  </script>
{% endblock %}
<div class="border-b bg-white border-primarylight">
  <nav x-cloak x-data="{ isMobileMenuOpen: false }"
       class="mx-auto max-w-screen-xl bg-white">
    <div class="mx-auto px-2 sm:px-6">
      <div class="relative flex h-20 items-center justify-between">
        <div class="absolute inset-y-0 left-0 flex items-center sm:hidden">
          <!-- Mobile menu button-->
          <button @click="isMobileMenuOpen = !isMobileMenuOpen" @click.outside="isMobileMenuOpen = false"
                  type="button"
                  class="relative inline-flex items-center justify-center rounded-md p-2 transition duration-100 ease-out text-textblackdim hover:bg-primarylight hover:text-black"
                  aria-controls="mobile-menu" aria-expanded="false">
            <span class="absolute -inset-0.5"></span>
            <span class="sr-only">Open main menu</span>
            <!--
              Icon when menu is closed.

              Menu open: "hidden", Menu closed: "block"
            -->
            <svg class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                 aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path>
            </svg>
            <!--
              Icon when menu is open.

              Menu open: "block", Menu closed: "hidden"
            -->
            <svg class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                 aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>

        </div>
        <!-- brand -->
        <div class="hidden items-center justify-center sm:flex sm:items-stretch sm:justify-start">
          <a href="{% url 'index' %}">
            <img class="h-9 w-auto" src="../../static/images/favicon.png"
                 alt="logo" href="{% url 'index' %}">
          </a>
          <span class="mx-3 text-2xl font-semibold italic text-primary">laid out</span>
        </div>

        <div class="absolute inset-y-0 right-0 flex items-center pr-2 sm:divide-x sm:divide-primarylight sm:static sm:inset-auto sm:ml-6 sm:pr-0">
          <div class="mr-3 hidden sm:ml-6 sm:block">
            <div class="flex space-x-4">
              <a href="{% url 'index' %}"
                 class="{% if current_page == 'home' %} bg-primary text-white font-semibold {% else %} hover:bg-primarylight hover:text-black {% endif %} text-sm text-textblackdim  rounded-md px-3 py-2 font-medium"
                 aria-current="page">Home</a>
              <a href="{% url 'anxiety_index' %}"
                 class="{% if current_page == 'anxiety' %} bg-primary text-white font-semibold {% else %} hover:bg-primarylight hover:text-black {% endif %} text-sm text-textblackdim  rounded-md px-3 py-2 font-medium">Anxiety</a>
              <a href="{% url 'about' %}"
                 class="{% if current_page == 'about' %} bg-primary text-white font-semibold {% else %} hover:bg-primarylight hover:text-black {% endif %} text-sm text-textblackdim  rounded-md px-3 py-2 font-medium">About</a>

            </div>
          </div>

          <div class="flex items-center">
            <!-- Dark/Light/System mode selection -->
            <div x-cloak
                 x-data="{ isThemeMenuOpen: false, currentTheme: localStorage.getItem('theme') || 'system' }"
                 class="relative z-10 ml-3">
              <button @click="isThemeMenuOpen = !isThemeMenuOpen" @click.outside="isThemeMenuOpen = false"
                      type="button"
                      class="relative flex rounded-md text-sm font-medium transition duration-100 ease-out text-textblackdim hover:bg-primarylight hover:text-black"
                      aria-expanded="false" aria-haspopup="true">
                <span class="sr-only">Open theme selection menu</span>
                <span class="px-3 py-1.5">
                <!-- If system preference is light or light is explicitly set -->
                  <svg x-show="currentTheme === 'system' ? window.matchMedia('(prefers-color-scheme: light)').matches : localStorage.theme === 'light'"
                       class="h-6 w-6 fill-textblackdim" viewBox="0 0 24 24" fill="none"
                       xmlns="http://www.w3.org/2000/svg">
                      <path d="M12 3v1m0 16v1m-8-9H3m3.314-5.686L5.5 5.5m12.186.814L18.5 5.5M6.314 17.69l-.814.81m12.186-.81.814.81M21 12h-1m-4 0a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round"></path>
                  </svg>
                  <!-- If system preference is dark or dark is explicitly set -->
                  <svg x-show="currentTheme === 'system' ? window.matchMedia('(prefers-color-scheme: dark)').matches : localStorage.theme === 'dark'"
                       class="h-6 w-6 fill-textblackdim" viewBox="0 0 24 24"
                       xmlns="http://www.w3.org/2000/svg">
                  <path d="M3.32 11.684a9 9 0 0 0 17.357 3.348A9 9 0 0 1 8.32 6.683c0-1.18.23-2.32.644-3.353a9.003 9.003 0 0 0-5.645 8.354Z"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                  </svg>

              </span>
              </button>

              <div x-transition:enter="transition ease-out duration-100"
                   x-transition:enter-start="opacity-0 scale-95"
                   x-transition:enter-end="opacity-100 scale-100"
                   x-transition:leave="transition ease-in duration-75"
                   x-transition:leave-start="opacity-100 scale-100"
                   x-transition:leave-end="opacity-0 scale-95"
                   x-show="isThemeMenuOpen" class="absolute right-0 mt-9 w-40
        origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5"
                   role="menu" aria-labelledby="theme-selection-button" tabindex="-1"
              >
                <a @click="localStorage.setItem('theme', 'light'); currentTheme = 'light';
                                            document.documentElement.classList.remove('dark')" href="#"
                   :class="{ 'bg-primary text-white font-semibold': currentTheme === 'light', 'hover:bg-primarylight hover:text-black': currentTheme !== 'light' }"
                   class="flex px-4 py-2 text-sm font-medium transition duration-100 ease-out group text-textblackdim"
                   role="menuitem" tabindex="-1">
                  <svg :class="{ 'fill-textwhitedim': currentTheme === 'light' }"
                       class="mr-2 h-5 w-5 fill-textblackdim" viewBox="0 0 24 24" fill="none"
                       xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 3v1m0 16v1m-8-9H3m3.314-5.686L5.5 5.5m12.186.814L18.5 5.5M6.314 17.69l-.814.81m12.186-.81.814.81M21 12h-1m-4 0a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"></path>
                  </svg>
                  Light
                </a>

                <a @click="localStorage.setItem('theme', 'dark');
                                   currentTheme = 'dark';
                                   document.documentElement.classList.add('dark')"
                   href="#"
                   :class="{ 'bg-primary text-white font-semibold': currentTheme === 'dark', 'hover:bg-primarylight hover:text-black': currentTheme !== 'dark' }"
                   class="flex px-4 py-2 text-sm font-medium transition duration-100 ease-out group text-textblackdim"
                   role="menuitem" tabindex="-1">
                  <svg :class="{ 'fill-textwhitedim': currentTheme === 'dark' }"
                       class="mr-2 h-5 w-5 fill-textblackdim" viewBox="0 0 24 24"
                       xmlns="http://www.w3.org/2000/svg">
                    <path d="M3.32 11.684a9 9 0 0 0 17.357 3.348A9 9 0 0 1 8.32 6.683c0-1.18.23-2.32.644-3.353a9.003 9.003 0 0 0-5.645 8.354Z"
                          stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                  </svg>
                  Dark
                </a>

                <a @click="localStorage.removeItem('theme'); currentTheme = 'system'; updateThemeBasedOnSystemPreference()"
                   href="#"
                   :class="{ 'bg-primary text-white font-semibold': currentTheme === 'system', 'hover:bg-primarylight hover:text-black': currentTheme !== 'system' }"
                   class="flex px-4 py-2 text-sm font-medium transition duration-100 ease-out group text-textblackdim"
                   role="menuitem" tabindex="-1">
                  <svg :class="{ 'fill-textwhitedim': currentTheme === 'system' }"
                       class="mr-2 h-5 w-5 fill-textblackdim" viewBox="0 0 24 24" fill="none"
                       xmlns="http://www.w3.org/2000/svg">
                    <path clip-rule="evenodd"
                          d="M2 6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-6v1h2a1 1 0 1 1 0 2H9a1 1 0 1 1 0-2h2v-1H5a3 3 0 0 1-3-3V6Zm3-1a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H5Z"
                    ></path>
                  </svg>
                  System
                </a>
              </div>
            </div>
            {% if not user.is_authenticated %}

              <!-- Login button -->
              <div class="relative ml-3">
                <div class="sm:block">
                  <div class="flex space-x-4">
                    <a href="{% url 'account_login' %}"
                       class="rounded-md px-3 py-2 font-medium text-textblackdim hover:bg-primarylight hover:text-black">Log
                      in</a>

                  </div>
                </div>
              </div>
            {% else %}

              <!-- Profile dropdown -->
              <div x-cloak x-data="{ isUserMenuOpen: false }" class="relative z-20 ml-3"
              >
                <button @click="isUserMenuOpen = !isUserMenuOpen" @click.outside="isUserMenuOpen = false"
                        type="button"
                        class="relative flex rounded-md px-3 py-2 text-sm transition duration-100 ease-out hover:bg-primarylight hover:text-black"
                        aria-expanded="false" aria-haspopup="true">
                  <span class="absolute -inset-1.5"></span>
                  <span class="sr-only">Open user menu</span>
                  <svg class="h-5 w-5 fill-textblackdim" viewBox="0 0 20 20"
                       xmlns="http://www.w3.org/2000/svg">
                    <path d="M16.563 18H3.438c-.706 0-1.228-.697-.961-1.338C3.713 13.698 6.617 12 10 12c3.384 0 6.288 1.698 7.524 4.662.267.641-.255 1.338-.961 1.338M5.917 6c0-2.206 1.832-4 4.083-4 2.252 0 4.083 1.794 4.083 4S12.252 10 10 10c-2.251 0-4.083-1.794-4.083-4m14.039 11.636c-.742-3.359-3.064-5.838-6.119-6.963 1.619-1.277 2.563-3.342 2.216-5.603-.402-2.623-2.63-4.722-5.318-5.028C7.023-.381 3.875 2.449 3.875 6c0 1.89.894 3.574 2.289 4.673-3.057 1.125-5.377 3.604-6.12 6.963C-.226 18.857.779 20 2.054 20h15.892c1.276 0 2.28-1.143 2.01-2.364"

                    ></path>
                  </svg>
                </button>
                <div x-transition:enter="transition ease-out duration-100"
                     x-transition:enter-start="opacity-0 scale-95"
                     x-transition:enter-end="opacity-100 scale-100"
                     x-transition:leave="transition ease-in duration-75"
                     x-transition:leave-start="opacity-100 scale-100"
                     x-transition:leave-end="opacity-0 scale-95"
                     x-show="isUserMenuOpen" class="absolute bg-white right-0 mt-9 w-40
                        origin-top-right rounded-md py-1 shadow-lg ring-1 ring-black ring-opacity-5
                        focus:outline-none"
                     role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button" tabindex="-1"
                >
                  <a href="{% url 'account_details' %}"
                     class="flex items-center px-4 py-2 text-sm font-medium transition duration-100 ease-out text-textblackdim hover:bg-primarylight hover:text-black"
                     role="menuitem" tabindex="-1"
                     id="user-menu-item-1">
                    <svg class="mr-2 h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <g stroke="currentColor" stroke-width="1.5">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M13.765 2.152C13.398 2 12.932 2 12 2c-.932 0-1.398 0-1.765.152a2 2 0 0 0-1.083 1.083c-.092.223-.129.484-.143.863a1.617 1.617 0 0 1-.79 1.353 1.617 1.617 0 0 1-1.567.008c-.336-.178-.579-.276-.82-.308a2 2 0 0 0-1.478.396C4.04 5.79 3.806 6.193 3.34 7c-.466.807-.7 1.21-.751 1.605a2 2 0 0 0 .396 1.479c.148.192.355.353.676.555.473.297.777.803.777 1.361 0 .558-.304 1.064-.777 1.36-.321.203-.529.364-.676.556a2 2 0 0 0-.396 1.479c.052.394.285.798.75 1.605.467.807.7 1.21 1.015 1.453a2 2 0 0 0 1.479.396c.24-.032.483-.13.819-.308a1.617 1.617 0 0 1 1.567.008c.483.28.77.795.79 1.353.014.38.05.64.143.863a2 2 0 0 0 1.083 1.083C10.602 22 11.068 22 12 22c.932 0 1.398 0 1.765-.152a2 2 0 0 0 1.083-1.083c.092-.223.129-.483.143-.863.02-.558.307-1.074.79-1.353a1.617 1.617 0 0 1 1.567-.008c.336.178.579.276.819.308a2 2 0 0 0 1.479-.396c.315-.242.548-.646 1.014-1.453.466-.807.7-1.21.751-1.605a2 2 0 0 0-.396-1.479c-.148-.192-.355-.353-.676-.555A1.617 1.617 0 0 1 19.562 12c0-.558.304-1.064.777-1.36.321-.203.529-.364.676-.556a2 2 0 0 0 .396-1.479c-.052-.394-.285-.798-.75-1.605-.467-.807-.7-1.21-1.015-1.453a2 2 0 0 0-1.479-.396c-.24.032-.483.13-.82.308a1.617 1.617 0 0 1-1.566-.008 1.617 1.617 0 0 1-.79-1.353c-.014-.38-.05-.64-.143-.863a2 2 0 0 0-1.083-1.083Z"></path>
                      </g>
                    </svg>
                    Settings</a>
                  <a href="{% url 'account_logout' %}"
                     class="flex items-center px-4 py-2 text-sm font-medium transition duration-100 ease-out text-textblackdim hover:bg-primarylight hover:text-black"
                     role="menuitem" tabindex="-1"
                     id="user-menu-item-2">
                    <svg class="mr-2 h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <g stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
                        <path d="M9.002 7c.012-2.175.109-3.353.877-4.121C10.758 2 12.172 2 15 2h1c2.829 0 4.243 0 5.122.879C22 3.757 22 5.172 22 8v8c0 2.828 0 4.243-.878 5.121C20.242 22 18.829 22 16 22h-1c-2.828 0-4.242 0-5.121-.879-.768-.768-.865-1.946-.877-4.121"></path>
                        <path d="M15 12H2m0 0 3.5-3M2 12l3.5 3" stroke-linejoin="round"></path>
                      </g>
                    </svg>
                    Log out</a>
                </div>
              </div>
            {% endif %}
          </div>


        </div>
      </div>
    </div>


    <div x-transition:enter="transition ease-out duration-100"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-100"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         x-show="isMobileMenuOpen" class="px-2 sm:hidden sm:px-6">
      <div class="px-2 pt-2 pb-3 space-y-1">
        <div class="flex h-max items-center space-x-4">
          <a href="{% url 'index' %}" class="">
            <img class="my-2 ml-3 h-9" src="../../static/images/favicon.png"
                 alt="logo" href="{% url 'index' %}">

          </a>
          <span class="mx-3 text-3xl font-semibold italic text-primary">laid out</span>
        </div>


        <a href="{% url 'index' %}"
           class="{% if current_page == 'home' %} bg-primary text-white font-semibold {% else %} transition ease-out duration-100 hover:bg-primarylight hover:text-black {% endif %} text-sm text-textblackdim block rounded-md px-3 py-2 font-medium"
           aria-current="page">Home</a>
        <a href="{% url 'anxiety_index' %}"
           class="{% if current_page == 'anxiety' %} bg-primary text-white font-semibold {% else %} transition ease-out duration-100 hover:bg-primarylight hover:text-black {% endif %} text-sm text-textblackdim block rounded-md px-3 py-2 font-medium"
           aria-current="page">Anxiety</a>
        <a href="{% url 'about' %}"
           class="{% if current_page == 'about' %} bg-primary text-white font-semibold {% else %} transition ease-out duration-100 hover:bg-primarylight hover:text-black {% endif %} text-sm text-textblackdim block rounded-md px-3 py-2 font-medium"
           aria-current="page">About</a>
      </div>
    </div>

  </nav>
</div>
